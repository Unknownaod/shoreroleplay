<!DOCTYPE html>
<html lang="en">
<head>
<title>Shore Roleplay | Whitelist Application</title>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- FONT -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box}

body{
  background:#000 url('https://i.imgur.com/vbt5BPF.jpeg') center/cover no-repeat fixed;
  color:#fff;
  font-family:"Inter",sans-serif;
  overflow-x:hidden;
}

/* ===== NAV ===== */
nav{
  display:flex;justify-content:space-between;align-items:center;
  padding:22px 65px;
  background:rgba(0,0,0,.45);
  backdrop-filter:blur(20px);
  border-bottom:1px solid rgba(255,255,255,.08);
  position:fixed;top:0;width:100%;z-index:1000;
  animation:navFade .6s ease-out forwards;
}
@keyframes navFade{
  from{opacity:0;transform:translateY(-20px);}
  to{opacity:1;transform:translateY(0);}
}

nav a,nav span{
  color:#dbe6ff;text-decoration:none;font-size:15px;
  font-weight:500;letter-spacing:.3px;margin-right:32px;
  transition:.25s;
}
nav a:hover{
  color:#4ea3ff;
  text-shadow:0 0 14px #4ea3ff;
  transform:translateY(-2px);
}
nav span{
  opacity:.45;cursor:default;
}

/* ===== MAIN CONTAINER ===== */
main{
  max-width:780px;margin:auto;padding:180px 20px 60px;text-align:center;
  animation:fadeIn .8s ease forwards;
}
@keyframes fadeIn{
  from{opacity:0;transform:translateY(25px);}
  to{opacity:1;transform:translateY(0);}
}

/* ===== TITLE ===== */
h1{
  font-size:3.8rem;font-weight:700;margin-bottom:14px;
  text-shadow:0 0 25px rgba(78,163,255,.55);
}
p.lead{
  opacity:.78;margin-bottom:55px;
  font-size:1.25rem;max-width:720px;margin-inline:auto;
}

/* ===== FORM ===== */
form{
  background:rgba(10,12,18,.78);
  backdrop-filter:blur(28px);
  padding:55px;border-radius:18px;
  border:1px solid rgba(255,255,255,.08);
  box-shadow:0 0 45px rgba(0,0,0,.65);
  text-align:left;
  transform:translateY(0);
  transition:.4s ease;
}
form:hover{transform:translateY(-4px)}

/* Inputs */
label{
  display:block;margin-top:26px;
  font-size:15px;font-weight:600;opacity:.92;
}
input,select,textarea{
  width:100%;padding:17px;border-radius:12px;
  border:1px solid rgba(255,255,255,.15);
  background:#0b0f17;color:#fff;margin-top:9px;
  font-size:15px;transition:.25s;
}
input:focus,select:focus,textarea:focus{
  border-color:#4ea3ff;box-shadow:0 0 15px #4ea3ff;
  outline:none;
}
textarea{resize:none;height:150px}

/* Agreements */
.agreement{
  margin-top:26px;padding:18px;border-radius:12px;
  background:#0b0f18;border:1px solid rgba(255,255,255,.12);
  font-size:14px;line-height:1.55;
}
.agreement input{
  margin-right:10px;transform:scale(1.3);cursor:pointer;
}

/* Submit Button */
button{
  margin-top:38px;padding:18px 36px;border-radius:12px;
  border:none;background:#4ea3ff;color:#fff;font-size:18px;
  font-weight:600;width:100%;cursor:pointer;
  letter-spacing:.35px;transition:.35s;
  box-shadow:0 0 18px rgba(78,163,255,.45);
}
button:hover:not(:disabled){
  transform:translateY(-4px) scale(1.03);
  box-shadow:0 0 30px rgba(78,163,255,.85);
}
button:disabled{opacity:.45;cursor:not-allowed}

/* Status Message */
#msg{margin-top:28px;font-size:1.2rem;min-height:32px;font-weight:600}

/* ===== FOOTER ===== */
footer{
  text-align:center;padding:45px;margin-top:90px;
  opacity:.42;font-size:14px;
  border-top:1px solid rgba(255,255,255,.08);
}
</style>
</head>
<body>

<!-- NAV -->
<nav>
  <div>
    <a href="index.html">Home</a>
    <a href="rules.html">Rules</a>
    <a href="departments.html">Departments</a>
    <a href="staff.html">Staff Panel</a>
    <span>Apply</span>
  </div>
</nav>

<!-- MAIN -->
<main>
  <h1>Shore Roleplay Whitelist</h1>
  <p class="lead">Submit your application to become a verified member of our roleplay community.</p>

  <form id="applyForm">
    <label>Discord Username</label>
    <input type="text" id="username" readonly>

    <label>Email Address</label>
    <input type="email" id="email" readonly>

    <label>Preferred Department</label>
    <select id="department" required>
      <option value="">— Select Department —</option>
      <option>Police Department</option>
      <option>State Police</option>
      <option>Sheriff's Office</option>
      <option>Fire Department</option>
      <option>Communications</option>
      <option>Civilian Operations</option>
    </select>

    <label>Tell us why you want to join</label>
    <textarea id="reason" placeholder="Explain your interest... Must be more than 100 characters." required></textarea>

    <div class="agreement">
      <label><input type="checkbox" id="agreeLogging">
      I acknowledge that my application, and submitted information may be securely logged and stored for administrative and auditing purposes.
      </label>
    </div>

    <div class="agreement">
      <label><input type="checkbox" id="agreeDiscord">
      I confirm that I am an active member of the Shore Roleplay Discord server and understand that providing false information or failing to remain in the server will result in immediate denial.
      </label>
    </div>

    <button id="submitBtn" type="submit" disabled>Submit Application</button>
  </form>

  <p id="msg"></p>
</main>

<footer>© 2025 Shore Roleplay — All Rights Reserved</footer>

<script>
const API = "https://shoreroleplay.onrender.com";
const btn = document.getElementById("submitBtn");

// Check login session
const user = JSON.parse(localStorage.getItem("shoreUser"));
if (!user) {
  alert("You must be logged in to submit an application.");
  window.location.href = "login.html";
}

// Autofill user data
document.getElementById("username").value = user.username;
document.getElementById("email").value = user.email;

// Agreement handler
function checkAgreements(){
  btn.disabled = !(document.getElementById("agreeLogging").checked && document.getElementById("agreeDiscord").checked);
}
document.getElementById("agreeLogging").addEventListener("change", checkAgreements);
document.getElementById("agreeDiscord").addEventListener("change", checkAgreements);

// Submit Handler
document.getElementById("applyForm").addEventListener("submit", async (e) => {
  e.preventDefault();
  btn.disabled = true;
  btn.textContent = "Submitting...";

  const body = {
    id: crypto.randomUUID(),
    username: user.username,
    email: user.email,
    department: document.getElementById("department").value,
    reason: document.getElementById("reason").value.trim(),
    agreedLogging: true,
    agreedDiscord: true
  };

  const res = await fetch(API + "/apply", {
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify(body)
  });

  const msg = document.getElementById("msg");
  if(res.ok){
    msg.style.color="#2ecc71";
    msg.textContent = "✔ Application submitted successfully!";
    e.target.reset(); btn.disabled = true;
  }else{
    msg.style.color="#e74c3c";
    msg.textContent = "❌ Something went wrong — please ensure all fields are valid.";
  }

  btn.textContent = "Submit Application";
});
</script>
</body>
</html>
